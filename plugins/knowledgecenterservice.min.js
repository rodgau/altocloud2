/*!
 * widgets
 * @version: 9.0.005.00
 * @license: Genesys Telecom Labs
 */
webpackJsonp([15],{"./webapp/plugins/cx-knowledge-center-service/cx-knowledge-center-service.js":function(e,s,n){"use strict";var t,i;t=[n("./webapp/lib/thirdparty/jquery-3.2.1.js"),n("./webapp/plugins/cx-knowledge-center-service/js/api-mapper-v1.js"),n("./webapp/plugins/cx-knowledge-center-service/js/api-mapper-v2.js")],void 0!==(i=function(e,s,n){function t(e){r.registerCommand(e,function(s){i(a[e](s.data),s)})}function i(e,s){e.done(function(e){s.deferred.resolve(e)}).fail(function(e){s.deferred.reject(e)})}var a=n,o={apiVersion:"v2",apiClientId:"gwidget",apiClientMediaType:"selfservice",media:"all",lang:"en",knowledgebases:[],maxTrendingResults:5,maxSearchResults:3},r=CXBus.registerPlugin("KnowledgeCenterService");r&&(r.registerEvents(["ready","online","sessionChanged","documentOpened","searched","suggested","voted","noResultsFound"]),r.registerCommand("configure",function(n){n&&n.data&&!e.isEmptyObject(n.data)?(o=e.extend({},o,n.data),o.apiVersion&&"V1"==o.apiVersion.toUpperCase()&&(a=s),a.initialize({host:o.host,knowledgebases:o.knowledgebases,lang:o.lang,media:o.media,apiClientId:o.apiClientId,apiClientMediaType:o.apiClientMediaType,maxSearchResults:o.maxSearchResults,oKnowledgeCenterService:r,tenantId:o.tenantId,apikey:o.apikey}),a.ping().done(function(){r.republish("online")}),n.deferred.resolve()):n.deferred.reject("KnowledgeCenterService is not configured")}),r.registerCommand("getTrending",function(e){i(a.getTrending({size:o.maxTrendingResults}),e)}),r.registerCommand("search",function(e){i(a.search({query:e.data.query,categories:e.data.categories,knowledgebases:e.data.knowledgebases,media:e.data.media,lang:e.data.lang,junkfree:e.data.junkfree,size:e.data.maxSearchResults,apiClientMediaType:e.data.apiClientMediaType}),e)}),r.registerCommand("reset",function(e){a.resetSession(),e.deferred.resolve()}),r.registerCommand("getFullContent",function(e){i(a.getFullContent({kbId:e.data.kbId,docId:e.data.docId,lang:e.data.lang}),e)}),t("getCategories"),t("visit"),t("vote"),t("unanswered"),t("sessionInfo"),t("getSuggestions"),r.command("KnowledgeCenterService.configure",window._genesys.widgets.knowledgecenter).done(function(){r.ready(),r.republish("ready")}))}.apply(s,t))&&(e.exports=i)},"./webapp/plugins/cx-knowledge-center-service/js/api-mapper-v1.js":function(e,s,n){"use strict";var t,i,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=[n("./webapp/lib/thirdparty/jquery-3.2.1.js"),n("./webapp/plugins/cx-common/cx-common.js")],void 0!==(i=function(e,s){function n(e){var s=[];for(var n in e)e.hasOwnProperty(n)&&e[n]&&s.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return 0!==s.length?"?"+s.join("&"):""}function t(e,s){var n="NONE";return e&&s&&e.forEach(function(e){e.id===s&&(n=e.feedbackType)}),n}function i(){var e,n=s.getCookie(l);if("string"==typeof n&&n.length>0)try{n=JSON.parse(n),e=n.sessionId}catch(e){console.log("Wrong value stored in cookies: "+n)}return e}function o(){s.deleteCookie(d),s.deleteCookie(l)}function r(e,s){return void 0===e||null===e?s:e}var d="_genesys.widgets.knowledgecenter.state.session",l="_genesys.widgets.knowledgecenter.state.keys";return{initialize:function(s){"object"===(void 0===s?"undefined":a(s))&&e.extend(this,s),this.setSessionId2(i()),s&&s.customerId&&this.associateSessionToUser(),this.kbs||this.getKnowledgeBases().done(function(e){this.kbs=e.knowledgebases}.bind(this))},ping:function(){return this.makeAjax({type:"GET",url:"/management/ping"})},getKnowledgeBases:function(){return this.makeAjax({type:"GET",url:"/kbs"+n({sessionId:this.sessionId,lang:this.lang,tenantId:this.tenantId})})},getCategories:function(){return this.makeAjax({type:"POST",url:"/kbs/langs/"+this.lang+"/categories"+n({sessionId:this.sessionId,tenantId:this.tenantId}),data:JSON.stringify({knowledgebases:this.knowledgebases,media:this.media})})},getTrending:function(e){return e.lang=r(e.lang,this.lang),e.knowledgebases=r(e.knowledgebases,this.knowledgebases),e.media=r(e.media,this.media),this.makeAjax({type:"POST",url:"/kbs/langs/"+e.lang+"/top"+n({size:e.size,sessionId:this.sessionId,tenantId:this.tenantId}),data:JSON.stringify({media:e.media,knowledgebases:e.knowledgebases})})},getFullContent:function(s){s.lang=r(s.lang,this.lang),this.visit(s);var i=new e.Deferred;return this.makeAjax({type:"GET",url:"/kbs/"+s.kbId+"/documents/"+s.docId+n({lang:s.lang,sessionId:this.sessionId,tenantId:this.tenantId})}).done(function(e){this.oKnowledgeCenterService.publish("documentOpened",{tenantId:this.tenantId,sessionId:this.sessionId,language:s.lang,knowledgebase:s.kbId,documentId:s.docId,document:e}),e.feedbackType=t(this.kbs,e.kbId),this.getRating({kbId:s.kbId,docId:s.docId}).done(function(s){e.additional=s,i.resolve(e)}).fail(function(){i.resolve(e)})}.bind(this)).fail(function(){i.reject()}),i},getRating:function(e){return e.lang=r(e.lang,this.lang),this.makeAjax({type:"GET",url:"/kbs/"+e.kbId+"/documents/"+e.docId+"/rating"+n({lang:e.lang,sessionId:this.sessionId,tenantId:this.tenantId})})},search:function(e){return e.query=r(e.query,""),e.categories=r(e.categories,[]),e.filters=r(e.filters,[]),e.lang=r(e.lang,this.lang),e.size=r(e.size,this.maxSearchResults),e.media=r(e.media,this.media),e.knowledgebases=r(e.knowledgebases,this.knowledgebases),this.makeAjax({type:"POST",url:"/kbs/langs/"+e.lang+"/search"+n({junkfree:e.junkfree,from:e.from,size:e.size,sessionId:this.sessionId,tenantId:this.tenantId}),data:JSON.stringify({query:e.query,categories:e.categories,media:e.media,filters:e.filters,knowledgebases:e.knowledgebases})}).done(function(s){0===s.documents.length?this.unanswered({question:e.query,knowledgebases:e.knowledgebases,lang:e.lang,categories:e.categories,filters:e.filters}):this.oKnowledgeCenterService.publish("searched",{tenantId:this.tenantId,sessionId:e.sessionId,language:e.lang,media:e.media,knowledgebases:e.knowledgebases,query:e.query,documents:s.documents})}.bind(this))},getSuggestions:function(e){return e.lang=r(e.lang,this.lang),e.knowledgebases=r(e.knowledgebases,this.knowledgebases),this.makeAjax({type:"POST",url:"/kbs/langs/"+this.lang+"/suggestions"+n({lang:e.lang,sessionId:this.sessionId,tenantId:this.tenantId}),data:JSON.stringify({query:e.query,categories:e.categories,filters:e.filters,media:this.media,knowledgebases:e.knowledgebases})}).done(function(s){this.oKnowledgeCenterService.publish("suggested",{tenantId:this.tenantId,sessionId:this.sessionId,media:this.media,language:e.lang,query:e.query,categories:e.categories,filters:e.filters,knowledgebases:e.knowledgebases})}.bind(this))},visit:function(e){return e.lang=r(e.lang,this.lang),this.makeAjax({type:"POST",url:"/feedback/"+e.kbId+"/documents/"+e.docId+"/visit"+n({lang:e.lang,sessionId:this.sessionId,tenantId:this.tenantId}),data:JSON.stringify({query:e.query,categories:e.categories,filters:e.filters})})},vote:function(e){return e.lang=r(e.lang,this.lang),e.relevant=r(e.relevant,!0),this.makeAjax({type:"POST",url:"/feedback/"+e.kbId+"/documents/"+e.docId+"/vote"+n({relevant:""+e.relevant,lang:e.lang,sessionId:this.sessionId,tenantId:this.tenantId}),data:JSON.stringify({query:e.query,categories:e.categories,filters:e.filters})}).done(function(s){this.oKnowledgeCenterService.publish("voted",{tenantId:this.tenantId,sessionId:this.sessionId,language:e.lang,relevant:e.relevant,knowledgebase:e.kbId,documentId:e.docId})}.bind(this))},unanswered:function(e){return e.lang=r(e.lang,this.lang),e.media=r(e.media,this.media),e.knowledgebases=r(e.knowledgebases,this.knowledgebases),this.makeAjax({type:"POST",url:"/feedback/unanswered"+n({lang:e.lang,sessionId:this.sessionId,tenantId:this.tenantId}),data:JSON.stringify(e)}).done(function(){this.oKnowledgeCenterService.publish("noResultsFound",{sessionId:this.sessionId,tenantId:this.tenantId,lang:e.lang,media:e.media,knowledgebases:e.knowledgebases,query:e.query})}.bind(this))},createSession:function(){return this.makeAjax({type:"PUT",url:"/sessions/new"})},associateSessionToUser:function(){return this.makeAjax({type:"POST",url:"/sessions/"+this.sessionId})},makeAjax:function(s){s.dataType="json",s.contentType="application/json; charset=UTF-8",s.url=this.host+s.url,s.crossDomain=!0,s.headers={gkc_customerId:this.customerId,gkc_apiClientId:this.apiClientId||"web",gkc_apiClientMediaType:this.apiClientMediaType};var n=new e.Deferred;return e.ajax(s).done(function(e){this.ajaxSuccess(n,e)}.bind(this)).fail(function(e){this.ajaxError(n,e),console.warn("Error while: "+s.type+" "+s.url)}.bind(this)),n.promise()},ajaxSuccess:function(e,s){s.error?e.reject(s.error,s.status):(this.setSessionId2(s.sessionId),e.resolve(s.response,s.status,this.sessionId))},ajaxError:function(e,s){e.reject(s.responseText,{code:s.status,message:s.statusText})},resetSession:function(){o()},sessionInfo:function(s){var n=new e.Deferred;if(!this.sessionId)return n.reject("Knowledge center session is not started yet"),n.promise();var t={sessionId:this.sessionId,language:this.lang,customer:this.customer,media:this.media};return n.resolve(t),n.promise()},setSessionId2:function(e){if(e){var n=!1;if(this.sessionId?this.sessionId!==e&&(this.sessionId=e,n=!0):(this.sessionId=e,n=!0),n){s.setCookie(l,JSON.stringify({sessionId:this.sessionId}));var t={sessionId:this.sessionId,language:this.lang,customer:this.customer,media:this.media,tenantId:this.tenantId};this.oKnowledgeCenterService.publish("sessionChanged",t)}}}}}.apply(s,t))&&(e.exports=i)},"./webapp/plugins/cx-knowledge-center-service/js/api-mapper-v2.js":function(e,s,n){"use strict";function t(e){if(Array.isArray(e)){for(var s=0,n=Array(e.length);s<e.length;s++)n[s]=e[s];return n}return Array.from(e)}var i,a,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i=[n("./webapp/lib/thirdparty/jquery-3.2.1.js"),n("./webapp/plugins/cx-common/cx-common.js")],void 0!==(a=function(e,s){function n(e){var s=[];for(var n in e)e.hasOwnProperty(n)&&e[n]&&s.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return 0!==s.length?"?"+s.join("&"):""}function i(e,s){var n="NONE";return e&&s&&e.forEach(function(e){e.id===s&&(n=e.feedbackType)}),n}function a(){var e,n=s.getCookie(h);if("string"==typeof n&&n.length>0)try{n=JSON.parse(n),e=n.sessionId}catch(e){console.log("Wrong value stored in cookies: "+n)}return e}function r(){s.deleteCookie(u),s.deleteCookie(h)}function d(e,s){return void 0===e||null===e?s:e}function l(e){var s={id:e.id,kbId:e.kbId,title:e.title,answer:e.content,answerContent:e.content,attachments:[],categories:[],relatedCategories:[]};return e.cats&&e.cats.forEach(function(e){s.categories.push(e.id),s.relatedCategories.push(c(e,s.kbId))}),s}function c(e,s){return{id:e.id,kbId:s,name:e.name,path:e.path}}function g(e){var s={documents:[],categories:[]};return e.docs.forEach(function(e){var n,i=l(e);s.documents.push(i),(n=s.categories).push.apply(n,t(i.relatedCategories))}),s}var u="_genesys.widgets.knowledgecenter.state.session",h="_genesys.widgets.knowledgecenter.state.keys";return{initialize:function(s){"object"===(void 0===s?"undefined":o(s))&&e.extend(this,s),this.setSessionId2(a()),s&&s.customerId&&this.associateSessionToUser(),this.kbs||this.getKnowledgeBases().done(function(e){this.kbs=e.kbs}.bind(this))},ping:function(){return this.makeAjax({type:"GET",url:"/health/v2/ping"})},getKnowledgeBases:function(){return this.makeAjax({type:"GET",url:"/config/v2/kbs/"})},getCategories:function(){return this.makeAjax({type:"GET",url:"/browse/v2/locales/"+this.lang+"/cats/"+n({kbs:this.knowledgebases,media:this.media})})},getTrending:function(s){s.lang=d(s.lang,this.lang),s.knowledgebases=d(s.knowledgebases,this.knowledgebases),s.media=d(s.media,this.media);var t=new e.Deferred;return this.makeAjax({type:"GET",url:"/search/v2/docs/top/"+n({locale:s.lang,kbs:s.kbs,n:s.size,outputFormat:"TEXT"})}).done(function(e){var s=g(e.docs);t.resolve(s)}).fail(function(){t.reject()})},getFullContent:function(s){s.lang=d(s.lang,this.lang),this.visit(s);var t=new e.Deferred,a=this;return this.makeAjax({type:"GET",url:"/browse/v2/locales/"+s.lang+"/kbs/"+s.kbId+"/docs/"+s.docId+n({outputFormat:"TEXT"})}).done(function(e){a.oKnowledgeCenterService.publish("documentOpened",{tenantId:a.tenantId,sessionId:a.sessionId,language:s.lang,knowledgebase:s.kbId,documentId:s.docId,document:e});var n=l(e.doc);n.feedbackType=i(a.kbs,n.kbId),t.resolve(n)}).fail(function(){t.reject()}),t},search:function(s){s.query=d(s.query,""),s.categories=d(s.categories,[]),s.filters=d(s.filters,[]),s.lang=d(s.lang,this.lang),s.size=d(s.size,this.maxSearchResults),s.media=d(s.media,this.media),s.knowledgebases=d(s.knowledgebases,this.knowledgebases);var t=new e.Deferred,i=this;return this.makeAjax({type:"GET",url:"/search/v2/search/"+n({locale:s.lang,kbs:s.knowledgebases,query:s.query,media:s.media,cats:s.categories,filters:s.filters,size:s.size,outputFormat:"TEXT"})}).done(function(e){0===e.docs.length?i.unanswered({lang:s.lang,searchId:e.searchId}):i.oKnowledgeCenterService.publish("searched",{tenantId:i.tenantId,sessionId:s.sessionId,language:s.lang,media:s.media,knowledgebases:s.knowledgebases,query:s.query,documents:e.docs});var n=g(e);n.query=s.query,n.searchId=e.searchId,t.resolve(n)}).fail(function(e){t.reject(e)}),t.promise()},getSuggestions:function(e){return e.lang=d(e.lang,this.lang),e.knowledgebases=d(e.knowledgebases,this.knowledgebases),this.makeAjax({type:"GET",url:"/search/v2/suggest/"+n({locale:e.lang,kbs:e.knowledgebases,text:e.query,cats:e.categories,filters:e.filters,media:e.media})}).done(function(s){this.oKnowledgeCenterService.publish("suggested",{tenantId:this.tenantId,sessionId:this.sessionId,media:this.media,language:e.lang,query:e.query,categories:e.categories,filters:e.filters,knowledgebases:e.knowledgebases})}.bind(this))},visit:function(e){return e.lang=d(e.lang,this.lang),this.makeAjax({type:"POST",url:"/feedback/v2/view"+n({locale:e.lang,kbId:e.kbId,docId:e.docId})})},vote:function(e){e.lang=d(e.lang,this.lang),e.relevant=d(e.relevant,!0);var s=e.relevant?"like":"dislike";return this.makeAjax({type:"POST",url:"/feedback/v2/"+s+n({locale:e.lang,kbId:e.kbId,docId:e.docId,searchId:e.searchId})}).done(function(s){this.oKnowledgeCenterService.publish("voted",{tenantId:this.tenantId,sessionId:this.sessionId,language:e.lang,relevant:e.relevant,knowledgebase:e.kbId,documentId:e.docId})}.bind(this))},unanswered:function(e){return e.lang=d(e.lang,this.lang),e.media=d(e.media,this.media),e.knowledgebases=d(e.knowledgebases,this.knowledgebases),this.makeAjax({type:"POST",url:"/feedback/v2/notfound"+n({locale:e.lang,searchId:e.searchId})}).done(function(){this.oKnowledgeCenterService.publish("noResultsFound",{sessionId:this.sessionId,tenantId:this.tenantId,lang:e.lang,media:e.media,knowledgebases:e.knowledgebases,query:e.query})}.bind(this))},createSession:function(){return this.makeAjax({type:"POST",url:"/session/v2/sessions/"})},associateSessionToUser:function(){return this.makeAjax({type:"PATCH",url:"/session/v2/sessions/"+this.sessionId})},makeAjax:function(s){s.dataType="json",s.contentType="application/json; charset=UTF-8",s.url=this.host+s.url,s.crossDomain=!0,s.headers={"x-api-key":this.apikey,ContactCenterID:this.tenantId,gkc_sessionId:this.sessionId,gkc_customerId:this.customerId,gkc_apiClientId:this.apiClientId||"web"};var n=new e.Deferred;return e.ajax(s).done(function(e,s,t){this.ajaxSuccess(n,e,t)}.bind(this)).fail(function(e,t){this.ajaxError(n,e),console.warn("Error while: "+s.type+" "+s.url)}.bind(this)),n.promise()},ajaxSuccess:function(e,s,n){this.setSessionId2(n.getResponseHeader("gkc_sessionId")),s.searchId&&(s.data.searchId=s.searchId),e.resolve(s.data,s.status,this.sessionId)},ajaxError:function(e,s){e.reject(s.responseText,{code:s.status,message:s.statusText})},resetSession:function(){r()},sessionInfo:function(s){var n=new e.Deferred;if(!this.sessionId)return n.reject("Knowledge center session is not started yet"),n.promise();var t={sessionId:this.sessionId,language:this.lang,customer:this.customer,media:this.media};return n.resolve(t),n.promise()},setSessionId2:function(e){if(e){var n=!1;if(this.sessionId?this.sessionId!==e&&(this.sessionId=e,n=!0):(this.sessionId=e,n=!0),n){s.setCookie(h,JSON.stringify({sessionId:this.sessionId}));var t={sessionId:this.sessionId,language:this.lang,customer:this.customer,media:this.media,tenantId:this.tenantId};this.oKnowledgeCenterService.publish("sessionChanged",t)}}}}}.apply(s,i))&&(e.exports=a)}},["./webapp/plugins/cx-knowledge-center-service/cx-knowledge-center-service.js"]);