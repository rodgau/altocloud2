/*!
 * widgets
 * @version: 9.0.005.00
 * @license: Genesys Telecom Labs
 */
webpackJsonp([21],{"./webapp/plugins/cx-clicktocall-service/cx-clicktocall-service.js":function(e,o,r){"use strict";var t,i,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=[r("./webapp/lib/thirdparty/jquery-3.2.1.js"),r("./webapp/plugins/cx-common/cx-common.js"),r("./webapp/lib/thirdparty/js.cookie.js"),r("./webapp/lib/thirdparty/URI.js")],void 0!==(i=function(e,o,r,t){var i=CXBus.registerPlugin("ClickToCallService");if(i){i.registerEvents(["ready","restored","numberReceived"]);var c={ajaxTimeout:3e3,provideAccessCode:!0,dataURL:"",iApiKey:"",userData:{}},n={postHttp:function(o,r){var t=e.Deferred(),i={};return e.extend(!0,i,c.userData||{},r||{}),e.ajax({url:o,data:i,type:"POST",timeout:c.ajaxTimeout,beforeSend:function(e){c.iApiKey&&e.setRequestHeader("apikey",c.iApiKey)},success:function(e){t.resolve(e||{})},error:function(e){t.reject(e||{})}}),t.promise()}},a=0,d={},u="_genesys.widgets.clicktocall.state",p=u+".expire",l=u+".phone_number",m=u+".phone_tel_href",f=u+".access_code",b=function(){a=parseInt(o.getCookie(p)||0);var e=new Date,r=e.getTime(),t=o.getCookie(f),i=o.getCookie(l),s=o.getCookie(m),c=Math.ceil((a-r)/1e3);return void 0!==i&&""!==i?{bRestoreSuccess:!0,sPhoneNumber:i,sPhoneTelHref:s,sAccessCode:t,iExipreTime:c}:{}},v=function(){o.deleteCookie(p),o.deleteCookie(f),o.deleteCookie(l),o.deleteCookie(m)},y=function(e){var r=new Date,t=r.getTime();a=t+1e3*e.iExpireTime;var i=e.sAccessCode,s=e.sPhoneNumber,c=e.sPhoneTelHref;o.setCookie(p,a),o.setCookie(f,i),o.setCookie(l,s),o.setCookie(m,c)},g=function(o){var r=!1;return(null==o||""==o||void 0===o||"object"==(void 0===o?"undefined":s(o))&&e.isEmptyObject(o))&&(r=!0),r};i.registerCommand("configure",function(o){var r=o.data;r&&!g(r)?("number"==typeof r.ajaxTimeout&&(c.ajaxTimeout=r.ajaxTimeout),"boolean"==typeof r.provideAccessCode&&(c.provideAccessCode=r.provideAccessCode),"string"==typeof r.dataURL&&(c.dataURL=r.dataURL),"string"!=typeof r.apikey&&"number"!=typeof r.apikey||(c.iApiKey=r.apikey),"object"!=s(r.userData)||g(r.userData)||e.extend(!0,c.userData,r.userData),o.deferred.resolve()):o.deferred.reject("Invalid configuration.")}),i.registerCommand("restore",function(e){var o=b();g(o)?e.deferred.resolve({bRestoreSuccess:!1}):(i.publish("restored",o),e.deferred.resolve(o))}),i.registerCommand("requestNumber",function(o){var r={_call_direction:"USERORIGINATED",_wait_for_agent:!1,_wait_for_user_confirm:!1,_provide_code:!1};r._customer_number=o.data.phonenumber,r._provide_code=c.provideAccessCode;var t={error:!1,netfail:!1,errormsg:"",sPhoneNumber:"",sAccessCode:"",iExpireTime:0},s={};e.extend(!0,s,r,o.data||{}),n.postHttp(c.dataURL,s).done(function(e){e.exception?(t.error=!0,t.errormsg=e.message):(t.sPhoneNumber=e._access_number,t.sAccessCode=e._access_code,t.sPhoneTelHref=e._tel_url,t.iExpireTime=parseInt(e._expiration_time),y(t)),i.publish("numberReceived",t),o.deferred.resolve(t)}).fail(function(e){e&&e.responseJSON&&e.responseJSON.exception?(t.error=!0,t.errormsg=e.responseJSON.message):t.netfail=!0,i.publish("numberReceived",t),o.deferred.reject(t)}),o.deferred.resolve(t)}),i.subscribe("GWE.ready",function(){i.command("GWE.getIDs").done(function(o){e.extend(!0,d,o)})}),i.subscribe("ClickToCall.expired",function(){v()}),i.command("configure",_genesys.widgets.clicktocall),i.ready(),i.republish("ready")}}.apply(o,t))&&(e.exports=i)}},["./webapp/plugins/cx-clicktocall-service/cx-clicktocall-service.js"]);