/*!
 * widgets
 * @version: 9.0.005.00
 * @license: Genesys Telecom Labs
 */
webpackJsonp([17],{"./webapp/plugins/cx-send-message-service/cx-send-message-service.js":function(e,t,a){"use strict";var r,s,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r=[a("./webapp/lib/thirdparty/jquery-3.2.1.js"),a("./webapp/plugins/cx-common/cx-common.js")],void 0!==(s=function(e,t){var a=CXBus.registerPlugin("SendMessageService");if(a){var r={dataURL:"",iApiKey:"",iAjaxTimeout:3e3,uploadsEnabled:!0},s=function(){return!!window.FormData},o={},i=function(e,t,r,s){400==e.status?e.responseText=JSON.parse(e.responseText):500==e.status&&(e.statusCode=202),a.publish("error",{result:e.responseText,textStatus:t,statusCode:e.status}),s.reject()},d=function(e,t,s,n){var o=r.uploadsEnabled?JSON.parse(e):e;o.interactionId?(a.publish("messageSent",{interactionId:o.interactionId}),n.resolve()):(e=JSON.parse(e),a.publish("error",{result:e,textStatus:t,jqXHR:s}),n.reject())},p=function(e){r.iApiKey&&e.setRequestHeader("apikey",r.iApiKey),r.ccid&&e.setRequestHeader("ContactCenterId",r.ccid)};a.registerEvents(["ready","messageSent","error"]),a.registerCommand("sendForm",function(t){if(t.data){var a=t.data.formData,n=e.extend({},o,t.data.userData||{});if(r.uploadsEnabled)if(s()){var u=new FormData;u.append("lastName",a.lastName||""),u.append("firstName",a.firstName||""),u.append("fromAddress",a.email||""),u.append("subject",a.subject||""),u.append("text",a.text||"");for(var c in n)u.append("userData",c+"="+n[c]);t.data.files&&e.each(t.data.files,function(e,t){u.append("files",t)}),e.ajax({type:"POST",url:r.dataURL,mimeType:"multipart/form-data",contentType:!1,crossDomain:!0,processData:!1,data:u,beforeSend:p,success:function(e,a,r){d(e,a,r,t.deferred)},error:function(e,a,r){i(e,a,0,t.deferred)}})}else t.deferred.reject("No HTMl5 formData support on your browser");else{var f,m=[],l={firstName:a.firstName||"",lastName:a.lastName||"",fromAddress:a.email||"",subject:a.subject||"",text:a.text||""};for(var c in l)m.push(encodeURIComponent(c)+"="+encodeURIComponent(l[c]));for(var c in n)m.push("userData="+encodeURIComponent(c+"="+n[c]));f=m.join("&").replace(/%20/g,"+"),e.ajax({type:"POST",url:r.dataURL,crossDomain:!0,timeout:r.iAjaxTimeout,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:f,beforeSend:p,success:function(e,a,r){d(e,a,r,t.deferred)},error:function(e,a,r){i(e,a,0,t.deferred)}})}}else t.deferred.reject("No formData found")}),a.subscribe("GWE.ready",function(){a.command("GWE.getIDs").done(function(t){e.extend(o,t)})}),a.registerCommand("configure",function(t){if(t.data){var a=t.data;"string"==typeof a.dataURL&&(r.dataURL=a.dataURL),"string"!=typeof a.apikey&&"number"!=typeof a.apikey||(r.iApiKey=a.apikey),"number"==typeof a.ajaxTimeout&&(r.iAjaxTimeout=parseInt(a.ajaxTimeout)),"boolean"==typeof a.uploadsEnabled&&(r.uploadsEnabled=a.uploadsEnabled),"object"==n(a.userData)&&e.extend(o,a.userData),a.ccid&&(r.ccid=a.ccid),t.deferred.resolve()}else t.deferred.reject("Invalid configuration")}),a.command("configure",_genesys.widgets.sendmessage),a.ready(),a.republish("ready")}}.apply(t,r))&&(e.exports=s)}},["./webapp/plugins/cx-send-message-service/cx-send-message-service.js"]);